CREATE TABLE [config].[tblEventType]
(
     [EventTypeId]   int            NOT NULL
    ,[EventTypeCode] nvarchar(3)     NOT NULL
    ,[Description]   nvarchar(64)    NOT NULL
    ,[AddDate]       datetime       NOT NULL
    ,[AddUser]       nvarchar(32)   NOT NULL
    ,[ModDate]       datetime       NOT NULL
    ,[ModUser]       nvarchar(32)   NOT NULL
    ,CONSTRAINT [PK_tblEventType] PRIMARY KEY CLUSTERED([EventTypeId] ASC)
    ,CONSTRAINT [NX1_tblEventType] UNIQUE NONCLUSTERED([EventTypeCode] ASC)
);
GO
--- <summary>
--- Updates ModUser/ModDate to trace changes.
--- </summary>
--- <concept>Configuration Audit</concept>
--- <event author="Piotr Purwin" date="2017-03-10" project="JLR MoDAS" UserStory="JLR MoDAS-92538>Trigger Created.</event>
CREATE TRIGGER [config].[trgEventType] ON [config].[tblEventType]
AFTER UPDATE

AS

BEGIN
	SET	NOCOUNT ON

    UPDATE	X
    SET
         ModDate = GETDATE()
		,ModUser = SYSTEM_USER
	FROM [config].[tblEventType] X
	INNER JOIN inserted I
		ON	I.[EventTypeId] = X.[EventTypeId]
END



TRUNCATE TABLE config.tblEventType;

INSERT INTO config.tblEventType
    (EventTypeId, EventTypeCode, Description, AddDate, AddUser, ModDate, ModUser)
VALUES 
     (1, 'SYS', 'SQL Error Messages'            ,GETDATE()  ,'MIG'  ,GETDATE()  ,'MIG')
    ,(2, 'BLD', 'Custom Build Error Message'    ,GETDATE()  ,'MIG'  ,GETDATE()  ,'MIG')
    ,(3, 'MSG', 'Message (Information Only)'    ,GETDATE()  ,'MIG'  ,GETDATE()  ,'MIG')

